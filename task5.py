from gmpy2 import *

p = int("134078079299425970995740249982058461274793658205923933\
77723561443721764030073546976801874298166903427690031\
858186486050853753882811946569946433649006084171".replace("\n", ""))

g = int("11717829880366207009516117596335367088558084999998952205\
59997945906392949973658374667057217647146031292859482967\
5428279466566527115212748467589894601965568".replace("\n", ""))

h = int("323947510405045044356526437872806578864909752095244\
952783479245297198197614329255807385693795855318053\
2878928001494706097394108577585732452307673444020333".replace("\n", ""))

hashes = []
B = 2 ** 20


for x1 in range(0, B):
    res = (h * invert(powmod(g, x1, p), p)) % p
    hashes.append(res)
    print "Creating hash #", x1
    
print "All hashes formed!"
    
for x0 in range(0, B):
    res = powmod(g, B * x0, p)
    #idx = find(res)
    if res in hashes:
        print "result x0 =", x0
        print "answer is", B*x0 + hashes.index(res)
        break
    print "Checking value", x0